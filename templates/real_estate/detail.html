{% extends 'base.html' %}
{% load static i18n %}

{% block title %}{{ property.title }}{% endblock %}

{% block extra_css %}
<style>
    .property_hero { position: relative; min-height: 60vh; display: flex; align-items: flex-end; padding: 60px 0 30px; background-position: center; background-size: cover; }
    .property_hero::before { content:''; position:absolute; inset:0; background: linear-gradient(180deg, rgba(0,0,0,.2) 0%, rgba(0,0,0,.5) 50%, rgba(0,0,0,.85) 100%); }
    .property_hero .container { position: relative; z-index: 2; }
    .property_title { color:#fff; font-weight:900; font-size: 2.5rem; margin:0 0 10px; }
    .property_badge { display:inline-block; background: linear-gradient(135deg,#ff6b35,#f7931e); color:#fff; padding:8px 16px; border-radius:999px; font-size:13px; font-weight:800; margin-inline-start:12px; }
    .property_badge.for_rent { background: linear-gradient(135deg,#4CAF50,#2E7D32); }
    .meta_row { display:flex; flex-wrap:wrap; gap:16px; color:#f1f1f1; opacity:.95; margin-top:12px; }
    .meta_item { display:flex; align-items:center; gap:8px; font-weight:600; font-size:15px; }
    .meta_item i { color:#ff6b35; font-size:16px; }

    .property_detail_wrap { background:#0f0f0f; padding: 50px 0 80px; }
    .left_col { color:#ddd; }
    .feature_grid { display:grid; grid-template-columns: repeat(auto-fit,minmax(200px,1fr)); gap:16px; margin: 24px 0 30px; }
    .feature_card { background:#161616; border:1px solid rgba(255,255,255,.08); border-radius:14px; padding:16px; display:flex; align-items:center; gap:12px; transition: all .3s ease; }
    .feature_card:hover { border-color: rgba(255,107,53,.3); transform: translateY(-2px); }
    .feature_card i { color:#ff6b35; font-size:20px; min-width:24px; }
    .feature_card_content { flex:1; }
    .feature_card_label { color:#aaa; font-size:13px; margin-bottom:4px; }
    .feature_card_value { color:#fff; font-weight:700; font-size:15px; }
    .property_cover { border-radius: 18px; overflow: hidden; border: 1px solid rgba(255,255,255,.08); box-shadow: 0 18px 40px rgba(0,0,0,.35); margin-bottom: 30px; }
    .property_cover img { width: 100%; height: auto; display: block; }
    .property_body { color:#e7e7e7; line-height: 2; font-size: 16px; }
    .amenities_grid { display:grid; grid-template-columns: repeat(auto-fit,minmax(180px,1fr)); gap:12px; margin:20px 0; }
    .amenity_item { display:flex; align-items:center; gap:10px; padding:12px; background:#161616; border:1px solid rgba(255,255,255,.08); border-radius:10px; }
    .amenity_item i { color:#4CAF50; font-size:18px; }
    .amenity_item span { color:#ddd; font-size:14px; }

    .property_sidebar { position: sticky; top: 90px; background: #161616; border: 1px solid rgba(255,255,255,.08); border-radius: 16px; padding: 24px; color: #ddd; }
    .property_price { color: #ff6b35; font-weight: 900; font-size: 28px; margin-bottom: 8px; }
    .property_status_badge { display:inline-block; padding:6px 12px; border-radius:999px; font-size:12px; font-weight:700; margin-bottom:16px; }
    .property_status_badge.for_sale { background:rgba(255,107,53,.2); color:#ff6b35; border:1px solid rgba(255,107,53,.3); }
    .property_status_badge.for_rent { background:rgba(76,175,80,.2); color:#4CAF50; border:1px solid rgba(76,175,80,.3); }
    .property_action { display:block; text-align:center; background: linear-gradient(135deg,#ff6b35,#f7931e); color:#fff; padding:16px 20px; border-radius:12px; font-weight:800; text-decoration:none; margin-top:12px; transition: all .3s ease; }
    .property_action:hover { color:#fff; text-decoration:none; box-shadow:0 12px 28px rgba(255,107,53,.35); transform: translateY(-2px); }
    .property_action.secondary { background:linear-gradient(135deg,#5a5a5a,#777); }
    .property_action.secondary:hover { box-shadow:0 12px 28px rgba(90,90,90,.35); }

    .section_head { color:#fff; font-weight:900; margin: 40px 0 16px; font-size:1.5rem; }
    .gallery_grid { display:grid; grid-template-columns: repeat(auto-fit,minmax(200px,1fr)); gap:12px; margin-top:20px; }
    .gallery_item { border-radius:12px; overflow:hidden; border:1px solid rgba(255,255,255,.08); cursor:pointer; transition: all .3s ease; }
    .gallery_item:hover { transform: scale(1.05); border-color: rgba(255,107,53,.4); }
    .gallery_item img { width:100%; height:180px; object-fit:cover; display:block; }
    .related_list { display:grid; grid-template-columns: repeat(auto-fit,minmax(280px,1fr)); gap:20px; margin-top:20px; }
    .related_card { background:#171717; border:1px solid rgba(255,255,255,.08); border-radius:14px; overflow:hidden; color:#ddd; text-decoration:none; transition: all .3s ease; }
    .related_card:hover { transform: translateY(-5px); border-color: rgba(255,107,53,.3); box-shadow: 0 15px 40px rgba(0,0,0,.4); text-decoration:none; }
    .related_card img { width:100%; height:180px; object-fit:cover; display:block; }
    .related_card_body { padding:16px; }
    .related_card_title { font-weight:800; color:#fff; margin-bottom:8px; }
    .related_card_meta { font-size:13px; color:#aaa; }

    @media (max-width: 768px) {
        .property_title { font-size: 1.8rem; }
        .feature_grid { grid-template-columns: 1fr; }
        .amenities_grid { grid-template-columns: 1fr; }
        .gallery_grid { grid-template-columns: repeat(2,1fr); }
        .related_list { grid-template-columns: 1fr; }
    }
</style>
{% endblock %}

{% block content %}
<div class="property_hero" style="background-image:url('{{ property.image.url }}');">
    <div class="container">
        <h1 class="property_title">{{ property.title }}{% if property.property_type %}<span class="property_badge {{ property.status }}">{{ property.get_status_display }}</span>{% endif %}</h1>
        <div class="meta_row">
            <div class="meta_item"><i class="fa fa-map-marker"></i><span>{{ property.location }}</span></div>
            {% if property.area %}<div class="meta_item"><i class="fa fa-arrows-alt"></i><span>{{ property.area }} m²</span></div>{% endif %}
            {% if property.rooms %}<div class="meta_item"><i class="fa fa-bed"></i><span>{{ property.rooms }} {% trans "اتاق" %}</span></div>{% endif %}
            {% if property.bathrooms %}<div class="meta_item"><i class="fa fa-bath"></i><span>{{ property.bathrooms }} {% trans "سرویس بهداشتی" %}</span></div>{% endif %}
            <div class="meta_item"><i class="fa fa-eye"></i><span>{{ property.views_count }} {% trans "بازدید" %}</span></div>
        </div>
    </div>
</div>

<div class="property_detail_wrap">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 left_col">
                <div class="feature_grid">
                    {% if property.area %}<div class="feature_card"><i class="fa fa-arrows-alt"></i><div class="feature_card_content"><div class="feature_card_label">{% trans "مساحت" %}</div><div class="feature_card_value">{{ property.area }} m²</div></div></div>{% endif %}
                    {% if property.rooms %}<div class="feature_card"><i class="fa fa-bed"></i><div class="feature_card_content"><div class="feature_card_label">{% trans "تعداد اتاق" %}</div><div class="feature_card_value">{{ property.rooms }}</div></div></div>{% endif %}
                    {% if property.bathrooms %}<div class="feature_card"><i class="fa fa-bath"></i><div class="feature_card_content"><div class="feature_card_label">{% trans "سرویس بهداشتی" %}</div><div class="feature_card_value">{{ property.bathrooms }}</div></div></div>{% endif %}
                    {% if property.property_type %}<div class="feature_card"><i class="fa fa-home"></i><div class="feature_card_content"><div class="feature_card_label">{% trans "نوع ملک" %}</div><div class="feature_card_value">{{ property.property_type.name }}</div></div></div>{% endif %}
                </div>

                <div class="property_cover"><img src="{{ property.image.url }}" alt="{{ property.title }}"></div>
                <div class="property_body">{{ property.description|safe }}</div>

                {% if property.has_parking or property.has_elevator or property.has_balcony or property.has_garden or property.is_furnished %}
                <h4 class="section_head">{% trans "امکانات و ویژگی‌ها" %}</h4>
                <div class="amenities_grid">
                    {% if property.has_parking %}<div class="amenity_item"><i class="fa fa-check-circle"></i><span>{% trans "پارکینگ" %}</span></div>{% endif %}
                    {% if property.has_elevator %}<div class="amenity_item"><i class="fa fa-check-circle"></i><span>{% trans "آسانسور" %}</span></div>{% endif %}
                    {% if property.has_balcony %}<div class="amenity_item"><i class="fa fa-check-circle"></i><span>{% trans "بالکن" %}</span></div>{% endif %}
                    {% if property.has_garden %}<div class="amenity_item"><i class="fa fa-check-circle"></i><span>{% trans "باغ/باغچه" %}</span></div>{% endif %}
                    {% if property.is_furnished %}<div class="amenity_item"><i class="fa fa-check-circle"></i><span>{% trans "مبله" %}</span></div>{% endif %}
                </div>
                {% endif %}

                {% if property.address %}
                <h4 class="section_head">{% trans "آدرس کامل" %}</h4>
                <div class="property_body">
                    <p><i class="fa fa-map-marker" style="color:#ff6b35;"></i> {{ property.address }}</p>
                    {% if property.google_maps_url %}<a href="{{ property.google_maps_url }}" target="_blank" class="property_action secondary" style="display:inline-block; margin-top:12px;"><i class="fa fa-map"></i> {% trans "مشاهده در نقشه گوگل" %}</a>{% endif %}
                </div>
                {% endif %}

                {% if property.images.all %}
                <h4 class="section_head">{% trans "گالری تصاویر" %}</h4>
                <div class="gallery_grid">
                    {% for img in property.images.all %}
                    <div class="gallery_item">
                        <img src="{{ img.image.url }}" alt="{{ img.caption|default:property.title }}">
                    </div>
                    {% endfor %}
                </div>
                {% endif %}

                {% if related_properties %}
                <h4 class="section_head">{% trans "املاک مرتبط" %}</h4>
                <div class="related_list">
                    {% for rp in related_properties %}
                    <a href="{% url 'real_estate:detail' slug=rp.slug %}" class="related_card">
                        <img src="{{ rp.image.url }}" alt="{{ rp.title }}">
                        <div class="related_card_body">
                            <div class="related_card_title">{{ rp.title }}</div>
                            <div class="related_card_meta">{{ rp.location }} - {{ rp.price|floatformat:0 }} TL</div>
                        </div>
                    </a>
                    {% endfor %}
                </div>
                {% endif %}
            </div>
            <div class="col-lg-4">
                <div class="property_sidebar">
                    <div class="property_price">{{ property.price|floatformat:0 }} TL</div>
                    <div class="property_status_badge {{ property.status }}">{{ property.get_status_display }}</div>
                    <div style="margin:16px 0; padding:16px 0; border-top:1px solid rgba(255,255,255,.08); border-bottom:1px solid rgba(255,255,255,.08);">
                        <div style="display:flex; justify-content:space-between; margin-bottom:8px;"><span style="color:#aaa;">{% trans "مساحت" %}</span><span style="color:#fff; font-weight:700;">{{ property.area }} m²</span></div>
                        {% if property.rooms %}<div style="display:flex; justify-content:space-between; margin-bottom:8px;"><span style="color:#aaa;">{% trans "اتاق" %}</span><span style="color:#fff; font-weight:700;">{{ property.rooms }}</span></div>{% endif %}
                        {% if property.bathrooms %}<div style="display:flex; justify-content:space-between;"><span style="color:#aaa;">{% trans "سرویس" %}</span><span style="color:#fff; font-weight:700;">{{ property.bathrooms }}</span></div>{% endif %}
                    </div>
                    <a href="{% url 'real_estate:inquiry' slug=property.slug %}" class="property_action">{% trans "استعلام قیمت و اطلاعات" %}</a>
                    <a href="{% url 'contact:contact' %}" class="property_action secondary">{% trans "تماس با ما" %}</a>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

